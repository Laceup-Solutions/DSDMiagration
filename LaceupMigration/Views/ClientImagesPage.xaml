<?xml version="1.0" encoding="utf-8" ?>
<local:LaceupContentPage xmlns:local="clr-namespace:LaceupMigration.Views" xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:LaceupMigration.ViewModels"
             xmlns:mi="http://www.aathifmahir.com/dotnet/2022/maui/icons"
             x:Class="LaceupMigration.Views.ClientImagesPage"
             x:DataType="vm:ClientImagesPageViewModel"
             Shell.NavBarIsVisible="True"
             Shell.TabBarIsVisible="False"
             Shell.BackgroundColor="{StaticResource White}"
             Title="Client Images">
    <Shell.BackButtonBehavior>
        <BackButtonBehavior Command="{Binding GoBackCommand}" />
    </Shell.BackButtonBehavior>
    <ContentPage.Content>
        <Grid RowDefinitions="Auto,*">
            <!-- Done button at top left -->
            <Button Grid.Row="0"
                    Text="Done"
                    Command="{Binding DoneCommand}"
                    Style="{StaticResource PrimaryButton}"
                    HorizontalOptions="Start"
                    Margin="16,8,0,8" />

            <ScrollView Grid.Row="1">
                <VerticalStackLayout Padding="16" Spacing="16">
                    <!-- Take Picture section with camera icon -->
                    <!-- Take Picture area -->
                    <Border StrokeThickness="1" Stroke="{StaticResource Gray300}" HeightRequest="120" WidthRequest="140"
                            BackgroundColor="{StaticResource White}" Padding="0" Margin="16,8">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8" />
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding TakePhotoCommand}" />
                        </Border.GestureRecognizers>
                        <VerticalStackLayout HorizontalOptions="Center" VerticalOptions="Center" Spacing="8" >
                            <Image Source="{mi:MaterialOutlined Icon=AddAPhoto, IconColor={StaticResource PrimaryDark}}"></Image>
                            <Label Text="Take Picture"
                                   FontSize="16"
                                   HorizontalTextAlignment="Center"
                                   FontAttributes="Bold"
                                   TextColor="{StaticResource PrimaryDark}"
                                   HorizontalOptions="Center" />
                        </VerticalStackLayout>
                    </Border>

                    <!-- Client Images heading -->
                    <Label Text="Client Images"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="{StaticResource PrimaryDark}"
                           Margin="0,8,0,8" />

                    <CollectionView ItemsSource="{Binding Images}"
                                    SelectionMode="None"
                                    IsVisible="{Binding ShowImages}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="vm:ClientImageViewModel">
                                <Grid ColumnDefinitions="Auto,*,Auto" 
                                      Margin="0,0,0,8"
                                      Padding="2">
                                    <Image Grid.Column="0"
                                           Source="{Binding ImagePath}"
                                           Aspect="AspectFill"
                                           HeightRequest="100"
                                           WidthRequest="100">
                                        <Image.GestureRecognizers>
                                            <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type vm:ClientImagesPageViewModel}}, Path=ViewImageCommand}"
                                                                   CommandParameter="{Binding .}" />
                                        </Image.GestureRecognizers>
                                    </Image>
                                    <Button Grid.Column="2"
                                            Text="Delete"
                                            Style="{StaticResource DeleteButton}"
                                            VerticalOptions="Center"
                                            Command="{Binding Source={RelativeSource AncestorType={x:Type vm:ClientImagesPageViewModel}}, Path=DeleteImageCommand}"
                                            CommandParameter="{Binding .}" />
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <!-- <Label Text="No images found." -->
                    <!--        IsVisible="{Binding ShowNoImages}" -->
                    <!--        HorizontalOptions="Center" -->
                    <!--        VerticalOptions="Center" -->
                    <!--        Margin="0,20,0,20" -->
                    <!--        TextColor="{StaticResource Gray500}" /> -->
                </VerticalStackLayout>
            </ScrollView>
        </Grid>
    </ContentPage.Content>
</local:LaceupContentPage>
